# MistyWithBackend
A Covid-19 screening system for Misty II that communicates with a backend

Instructions for use:
This system uses the robot Misty II, an administrator pc of some kind, and a microsoft Azure account for cloud database access. The code is written in JavaScript. The backend code on the administrator PC has a few dependencies. They are node.js, tedious, express, body-parser, cors, and twilio. These must be installed (i.e. ‘npm install tedious’). A separate tunneling program must be installed for this specific implementation of the backend. We used ngrok, which is free, however each time ngrok is opened it will refresh its connection url, which will need to be changed in the code on Misty itself (paid versions allow for a permanent URL, which would be needed for commercial use of this system). Other services we used were Azure SQL database and twilio (a texting service). Both of these have free versions but eventually require a subscription. We also had to use a VPN when on the university’s network, as otherwise you cannot connect to the Azure cloud database.

For the system to work, the administrator pc will be running the backend js file as well as ngrok set to localhost:3000. The flow of the system is as follows, Misty continuously scans for faces, once one is detected it will check to see if that is a known face. At the current time if the face is unknown an administrator will need to register that person with misty, as a name must be entered from the command center. The administrator will also likely want to enter their information into the cloud database at this time. If the face belongs to a known user, Misty will greet the client and then query the database for their information. There are 2 queries that misty performs on the cloud database, one GET and one POST request. The GET request uses the “id” to obtain a certain row of the database (i.e. “tunnelingurl.io/record/JohnSmith”). The request is sent through the tunneler to the js backend which then formally queries the database, receives and parses the info, then sends it back to Misty. Misty then uses the info to text the user the results of their temperature check (either cleared for entry or denied entry based on the temperature). The temperature is received from the temperature sensor via the arduino backpack. This specific sensor seems to be about 8 degrees fahrenheit off, so we adjust for that, however before professional use the sensor will need to be scientifically calibrated. Once the temperature is gauged, the system sends a post request with a JSON body so that no personal info is leaked via URL. This POST request is, again, sent through the tunneler and then handled by the backend program. The backend program updates the cloud database through a query. The updated information is the temperature, clear state, and the current date. At this time the date updates to include the time, however (possibly due to my lowest-tier Azure subscription) it does not correctly record the time, only the date. Once the cloud database is updated it can be queried to check things such as every member that has had their temperature read in the last three days or which people have a “clear” or “not clear” state. Our database currently has the columns: Full name (with no space between first and last names), phone number, email address, JagNumber, last known temperature, clear state, and last temperature reading date. Other implementations of this project could easily use different attributes in the database depending on their specific needs. 
